name: Suggest A Tip
run-name: How much do you want to tip ${{ github.actor }}?
on: [pull_request]
jobs:
  suggest_tips:
    permissions:
      pull-requests: write
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
      - name: Count changed lines
        id: count-lines
        if: success()
        run: |
          changed_lines=$(git diff --shortstat origin/main origin/${GITHUB_HEAD_REF} | awk '{s+=$4} END {print s}')
          echo "CHANGED_LINES=$changed_lines" >> $GITHUB_ENV
      - name: Comment PR
        if: success()
        uses: thollander/actions-comment-pull-request@v2
        with:
          message: |
            Please choose an option to tip:
            $1.00/line: ${{ env.CHANGED_LINES }}
            $0.75/line: ${{ env.CHANGED_LINES * 0.75 }}
            $0.50/line: ${{ env.CHANGED_LINES * 0.50 }}
      - run: echo "Awesome!"
        if: always()
            
            
